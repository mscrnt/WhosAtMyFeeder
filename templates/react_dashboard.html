{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
  <div id="root"></div>
{% endblock %}

{% block scripts %}
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script type="text/babel">
    function App() {
      const [trending, setTrending] = React.useState([]);
      React.useEffect(() => {
        fetch('/api/trending')
          .then(res => res.json())
          .then(data => setTrending(data));
      }, []);
      return (
        <div>
          <h2><i class="fa-solid fa-chart-line"></i> Trending Species</h2>
          <table className="table table-hover table-striped">
            <thead>
              <tr><th>Common Name</th><th>Detections</th></tr>
            </thead>
            <tbody>
              {trending.map(sp => (
                <tr key={sp.scientific_name}>
                  <td>{sp.common_name}</td>
                  <td>{sp.count}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      );
    }
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
{% endblock %}
